(function(){window.customElements.define("zero-md",class extends HTMLElement{get version(){return"v1.3.3"}get src(){return this.getAttribute("src")}get manualRender(){return this.hasAttribute("manual-render")}get noShadow(){return this.hasAttribute("no-shadow")}get markedUrl(){return this.getAttribute("marked-url")||window.ZeroMd.config.markedUrl}get prismUrl(){return this.getAttribute("prism-url")||window.ZeroMd.config.prismUrl}get cssUrls(){let a=this.getAttribute("css-urls");return a?JSON.parse(a):window.ZeroMd.config.cssUrls}constructor(){super(),window.ZeroMd=window.ZeroMd||{},window.ZeroMd.markedjs=window.ZeroMd.markedjs||{},window.ZeroMd.markedjs.options=window.ZeroMd.markedjs.options||{},window.ZeroMd.config=window.ZeroMd.config||{},window.ZeroMd.config.baseUrl=window.ZeroMd.config.baseUrl||"",window.ZeroMd.config.markedUrl=window.ZeroMd.config.markedUrl||"https://cdn.jsdelivr.net/npm/marked@0/marked.min.js",window.ZeroMd.config.prismUrl=window.ZeroMd.config.prismUrl||"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js",window.ZeroMd.config.cssUrls=window.ZeroMd.config.cssUrls||["https://cdn.jsdelivr.net/npm/github-markdown-css@2/github-markdown.min.css","https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism.min.css"],window.ZeroMd.cache=window.ZeroMd.cache||{}}connectedCallback(){this.addEventListener("click",this._hijackLinks.bind(this)),this.addEventListener("zero-md-rendered",function a(){this.removeEventListener("zero-md-rendered",a),window.setTimeout(()=>{this._scrollTo(window.location.hash)})}.bind(this)),this.manualRender||this.render(),this._fire("zero-md-ready")}_fire(a){this.dispatchEvent(new CustomEvent(a,{bubbles:!0,composed:!0}))}_ajaxGet(a){return new Promise((b,c)=>{if(!a)return void c(a);const d=a.startsWith("http")?a:window.ZeroMd.config.baseUrl+a;let e=new XMLHttpRequest,f=a=>{console.warn("[zero-md] Error getting file",d),c(a)};e.open("GET",d,!0),e.onload=()=>{200<=e.status&&400>e.status?b(e.responseText):f(e)},e.onerror=a=>f(a),e.send()})}_loadScript(a,b,c,...d){return new Promise((e,f)=>{if("undefined"!==b)return void e();if(window.ZeroMd.cache.hasOwnProperty(c))window.addEventListener(c,function a(){window.removeEventListener(c,a),e()});else{window.ZeroMd.cache[c]=!0;let b=document.createElement("script");for(let a of d)b.setAttribute(a,"");b.onload=()=>{this._fire(c),e()},b.onerror=b=>{console.warn("[zero-md] Error loading script",a),f(b)},b.src=a,document.head.appendChild(b)}})}_getStylesheet(a){return new Promise((b,c)=>{window.ZeroMd.cache[a]?window.ZeroMd.cache[a].loaded?b(window.ZeroMd.cache[a].data):window.addEventListener(a,function c(){window.removeEventListener(a,c),b(window.ZeroMd.cache[a].data)}):(window.ZeroMd.cache[a]={loaded:!1,data:""},this._ajaxGet(a).then(c=>{window.ZeroMd.cache[a].data=c,window.ZeroMd.cache[a].loaded=!0,this._fire(a),b(c)},a=>c(a)))})}_getInputs(){return new Promise((a,b)=>{let c=this.querySelector("template")&&this.querySelector("template").content.querySelector("xmp")||!1;return c?void a(c.textContent):void this._ajaxGet(this.src).then(b=>a(b)).catch(a=>b(a))})}_prismHighlight(a,b){return window.Prism.highlight(a,this._detectLang(a,b))}_detectLang(a,b){return b?window.Prism.languages.hasOwnProperty(b)?window.Prism.languages[b]:"es"===b.substr(0,2)?window.Prism.languages.javascript:"c"===b?window.Prism.languages.clike:window.Prism.languages.markup:a.match(/^\s*</)?window.Prism.languages.markup:window.Prism.languages.javascript}_stampDom(a){let b=this.querySelectorAll("[class^=markdown]");if(b&&b.forEach(a=>this.removeChild(a)),this.shadowRoot&&(this.shadowRoot.innerHTML=""),this.noShadow)this.insertAdjacentHTML("afterbegin",a);else{let b=this.shadowRoot||this.attachShadow({mode:"open"});b.innerHTML=a}}_buildMd(){return new Promise((a,b)=>{Promise.all([this._getInputs(),this._loadScript(this.markedUrl,typeof window.marked,"zero-md-marked-ready","async"),this._loadScript(this.prismUrl,typeof window.Prism,"zero-md-prism-ready","async","data-manual")]).then(b=>{const c=new window.marked.Renderer;c.heading=(a,b)=>{const[,c,d]=a.match(/^(.*)?\s*{#(.*)}$/mi)||[null,a],e=d||c.toLowerCase().replace(/[^\w]+/g,"-");return`<h${b} id="${e}">${c}</h${b}>`};let d=b[0];const e=/====+/gmi;d=d.replace(e,"<div style=\"page-break-after: always;\"></div>");const f=/===/gmi;d=d.replace(f,"<br/>".repeat(40));const g=/```python/gmi;d=d.replace(g,"```");const h=/\.md\)/gmi;d=d.replace(h,"-md)");const i=/\.md#/gmi;d=d.replace(i,"-md#");const j=/---[a-z]*\n([\s\S]*?)\n---/gmi;d=d.replace(j,(a,b)=>{let c=b;const d=[[/(___)(.*?)\1/gmi,"<em>$2</em>"],[/(__)(.*?)\1/gmi,"<b>$2</b>"],[/(\*\*)(.*?)\1/gmi,"<b>$2</b>"],[/(____)(.*?)\1/gmi,"<span style=\"text-decoration:underline\">$2</span>"]];for(const e of d)c=c.replace(e[0],e[1]);return`<pre>${c}</pre>`});const k={renderer:c,highlight:this._prismHighlight.bind(this)},l=window.marked(d,Object.assign(k,window.ZeroMd.markedjs.options));a("<div class=\"markdown-body\">"+l+"</div>")},a=>{b(a)})})}_buildStyles(){return new Promise(a=>{let b="<style class=\"markdown-style\">:host{display:block;position:relative;contain:content;}",c="</style>",d=this.querySelector("template")&&this.querySelector("template").content.querySelector("style")||!1;return d?void a("<style class=\"markdown-style\">:host{display:block;position:relative;contain:content;}"+d.textContent+c):void(Array.isArray(this.cssUrls)&&this.cssUrls.length?Promise.all(this.cssUrls.map(a=>this._getStylesheet(a))).then(d=>a(b+d.join("")+c)).catch(()=>a(b+c)):(console.warn("[zero-md] No styles are defined"),a("<style class=\"markdown-style\">:host{display:block;position:relative;contain:content;}"+c)))})}_scrollTo(a){if(a&&this.shadowRoot){let b=this.shadowRoot.getElementById(a.substr(1));b&&b.scrollIntoView()}}_hijackLinks(a){let b=a.path||a.composedPath();if("A"===b[0].tagName){const c=b[0];c.hash&&c.origin+c.pathname===window.location.origin+window.location.pathname&&(a.metaKey?window.open(c.href,"_blank"):(this._scrollTo(c.hash),window.location=c.href),a.preventDefault())}}render(){Promise.all([this._buildStyles(),this._buildMd()]).then(a=>{this._stampDom(a[0]+a[1]),this._fire("zero-md-rendered")})}})})(window,document);